from typing_extensions import TypedDict
from langgraph.graph import StateGraph, START, END
class MainState(TypedDict):
  maintext: str

class SubState(TypedDict):
  subtext: str


def substate_func(state:SubState):
  state["subtext"] = " |inside subgraph"
  return state
sub_graph_builder = StateGraph(SubState)
sub_graph_builder.add_node("firstinner", substate_func)
sub_graph_builder.add_edge(START,"firstinner")
sub_graph_builder.add_edge("firstinner",END)

subcompile = sub_graph_builder.compile()

def node1_mainstate(state:MainState):
  state["maintext"] = "This is my main first node"
  
  return state
def node2_mainstate_substate(state:MainState):
  sub_input: SubState = {
  "subtext" : state["maintext"]    
  }

  sub_result = subcompile.invoke(sub_input)
  
  state["maintext"] = sub_result["subtext"]
  return state
  def node3_mainstate(state: MainState):
  state["maintext"] = "This is my node 3"
  return state
  main_graph_builder = StateGraph(MainState)
main_graph_builder.add_node("firstNode", node1_mainstate)
main_graph_builder.add_node("SecondNode", node2_mainstate_substate)
main_graph_builder.add_node("ThirdNode", node3_mainstate)

main_graph_builder.add_edge(START,"firstNode")
main_graph_builder.add_edge("firstNode","SecondNode")
main_graph_builder.add_edge("ThirdNode",END)

maincompile = main_graph_builder.compile()

if __name__ == "__main__":
    print("\n--- CASE 2: DIFFERENT STATE ---")
    result_case2 = maincompile.invoke({"maintext": "start"})
    print(result_case2)
