def summarize_content_json(content_json: dict, file_name: str | None = None) -> str:
    """
    Summarise the text stored under content_json["content"].

    - Uses :selected: / :unselected: as checkbox indicators.
    - Only mentions options clearly marked as selected.
    """
    raw_text = content_json.get("content", "")
    cleaned_text = clean_content_text(raw_text)

    prompt = f"""
You are an experienced Commercial Insurance Underwriter.

You are given the raw textual content of a commercial insurance application
(ACORD-style form). Your job is to write a short, underwriting-focused summary.

IMPORTANT FORMAT MARKERS IN THE TEXT:
- The text uses ':selected:' and ':unselected:' to indicate checkboxes.
- Treat ':selected:' as meaning "this option is chosen/ticked".
- Treat ':unselected:' as meaning "this option is NOT chosen".
- When summarising, you should:
  - Use information from fields or options that are clearly associated
    with ':selected:'.
  - Generally ignore options that are ':unselected:' unless the text
    explicitly states something important about them (for example, a
    clear "No" answer to a general information question).

STRICT RULES (YOU MUST OBEY ALL):
1. Use ONLY information that is explicitly present in the text below.
   - If something is not clearly stated, do NOT mention it.
   - Do NOT guess or infer anything that is not literally present.
2. Do NOT mention:
   - document structure (pages, sections, ACORD numbers),
   - boilerplate fraud / privacy / legal warning paragraphs,
   - instructions to applicants, producer signature boilerplate, etc.
3. Do NOT say that something is "not provided", "not mentioned",
   "no other schedules", "no other attachments", or similar.
4. Do NOT rephrase "TBD" as "yet to be determined" or "not decided";
   only say "TBD" if it appears exactly in the text.
5. If a line of business, attachment, or option appears with multiple
   choices and some are ':selected:' and others ':unselected:',
   only mention what is actually ':selected:'.

WRITING STYLE:
- Output exactly ONE paragraph of 4–6 sentences.
- Write like an underwriter summarising a submission for a colleague.
- Focus on key underwriting-relevant points such as:
  **Insured Name**, **Location**, **Nature of Operations / Description of Operations**,
  **Status of Transaction** (e.g., QUOTE if marked selected),
  **Line(s) of Business requested**, **Proposed Effective and Expiration Dates**,
  **Annual revenues**, **type of premises and occupancy**, **prior carrier history**,
  and any special exposures explicitly described.
- Do NOT list fields one by one; combine related facts into smooth sentences.
- Use bold formatting for a few important labels that ARE present
  (e.g. **Insured Name**, **Location**, **Proposed Effective Date**,
  **Line of Business**, **Annual Revenues**, **Nature of Operations**, etc.).
  Do NOT bold more than about 4–7 phrases.

Now, using ONLY the text below, write such a paragraph:

=== APPLICATION TEXT START ===
{cleaned_text}
=== APPLICATION TEXT END ===
    """

    response = client.chat.completions.create(
        model=AZURE_OPENAI_CHAT_DEPLOYMENT,
        messages=[{"role": "user", "content": prompt}],
        max_tokens=256,
        temperature=0.1,
    )

    try:
        return response.choices[0].message.content.strip()
    except Exception:
        return getattr(response.choices[0].message, "content", "").strip()
