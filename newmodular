from datetime import datetime
from models.model_data import QuoteData
from State_Abbrevation.us_state_abbrevation import us_states_abbreviations


def get_value_anywhere(data, target_key):
    """
    Find a key anywhere in nested dict/list JSON.
    Returns first match or None.
    """
    if isinstance(data, dict):
        for key, value in data.items():
            if key == target_key:
                return value
            found = get_value_anywhere(value, target_key)
            if found is not None:
                return found

    elif isinstance(data, list):
        for item in data:
            found = get_value_anywhere(item, target_key)
            if found is not None:
                return found

    return None


def map_document_to_model_data(doc: dict) -> QuoteData:
    # Get values from anywhere in JSON
    company_name = get_value_anywhere(doc, "Named Insured (Company Name)")
    organization_type = get_value_anywhere(doc, "Organization Type")

    address_line1 = get_value_anywhere(doc, "Address Line 1")
    city = get_value_anywhere(doc, "City")
    full_state_name = get_value_anywhere(doc, "State")
    postal_code = get_value_anywhere(doc, "Zip Code")

    date_str = get_value_anywhere(doc, "Effective Date")

    # Convert the date string to desired format, with error handling
    if date_str:
        try:
            date_obj = datetime.strptime(date_str, "%d/%m/%Y")
            job_effective_date = date_obj.strftime("%Y-%m-%d")
        except ValueError:
            job_effective_date = None
    else:
        job_effective_date = None

    # Lookup state abbreviation
    state_abbreviation = us_states_abbreviations.get(
        full_state_name, full_state_name
    )

    return QuoteData(
        company_name=company_name,
        organization_type=organization_type or "",

        address_line1=address_line1,
        city=city,
        state=state_abbreviation,
        postal_code=postal_code,

        # Fixed producer code as per business rule
        producer_code="pc:6",

        job_effective_date=job_effective_date
    )








This is my current code 


from State_Abbrevation.us_state_abbrevation import us_states_abbreviations

def map_document_to_model_data(doc: dict) -> QuoteData:
    insured = doc.get("Insured Information", {})
    broker = doc.get("Broker and Producer Information", {})
    location = doc.get("Property Location", {})
    policy = doc.get("Coverage and Policy Details", {})

    # Extract the date string
    date_str = policy.get("Effective Date")

    # Convert the date string to desired format, with error handling
    if date_str:
        try:
            date_obj = datetime.strptime(date_str, '%d/%m/%Y')
            job_effective_date = date_obj.strftime('%Y-%m-%d')
        except ValueError:
            # Handle invalid date format gracefully
            job_effective_date = None
    else:
        job_effective_date = None



    # Get the full state name from location
    full_state_name = location.get("State")

    # Lookup abbreviation; fallback to original full name or None if not found
    state_abbreviation = us_states_abbreviations.get(full_state_name, full_state_name)


    return QuoteData(
        company_name=insured.get("Named Insured (Company Name)"),
        organization_type=insured.get("Organization Type", ""),

        address_line1=location.get("Address Line 1"),
        city=location.get("City"),
        # state=location.get("State"),
        state = state_abbreviation,
        postal_code=location.get("Zip Code"),

        # producer_code=broker.get("Producer Code"),
        producer_code="pc:6",

        job_effective_date=job_effective_date
    )

here i want to keep the code modular what i meant, is not everytime , "Named Insured (Company Name)" this will be present in "Insured Information", it can be in any section similarly for everyone for eg, Organization Type not everytime it will be in "Insured Information" so no matter in whcih section it is it should get it,  
